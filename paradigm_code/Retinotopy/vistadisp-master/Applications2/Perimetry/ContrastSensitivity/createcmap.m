function [cmap]=createcmap(display,contrast)backColor = display.reservedColor(findName(display.reservedColor,'background')).gunVal;backIndex = display.reservedColor(findName(display.reservedColor,'background')).fbVal;% minVal is the lowest available colormap value (excluding reserved colors), maxVal is the highest.  minVal = max([display.reservedColor(:).fbVal])+1;maxVal = display.numColors-1;% Ensure there is an odd number of cmap entries so that% middle-gray is represented.if(mod((maxVal-minVal+1)/2,2) == 0)  maxVal = maxVal - 1;end% this is a simpler version of odd check. is it ok to use it instead?% if(mod(maxVal-minVal+1,2) == 0)%   maxVal = maxVal - 1;% endcmapIndices = [minVal:maxVal];cmap = zeros(display.numColors,3);ramp = [linspace(-0.5,0.5,length(cmapIndices))]';% For each row of cmap begining at minVal!!! it calculate RGB using contrast% Matlab work indices 1 ...  and Psycho from 0 ....% repmat : to replicate for R , G and B cmap(cmapIndices+1,:) = floor((repmat(contrast * ramp, 1, 3) + 0.5) * display.maxGunVal);% it just put the reserved colors in the initials entries of cmapcmap = insertReservedCols(display,cmap);